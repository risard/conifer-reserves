[% WRAPPER default/base.tt2 %]
<script src='[% ctx.media_prefix %]/js/ui/default/conify/global/permission/grp_penalty_threshold.js'> </script>
<h1>Group Penalty Thresholds</h1><br/>

<!-- grp, penalty, org_unit, threshold -->

<div dojoType="dijit.form.DropDownButton">
    <span>New Group Penalty Threshold</span>
    <div dojoType="dijit.TooltipDialog" execute="GPT.create(arguments[0]);">
        <script type='dojo/connect' event='onOpen'>
            new openils.User().buildPermOrgSelector('CREATE_GROUP_PENALTY_THRESHOLD', gptOwningOrg);
            GPT.drawCspSelector();
            GPT.grpSelector.drawGroups();
        </script>
        <table class='dijitTooltipTable'>
            <tr>
                <td><label for="name">Group: </label></td>
                <td>
                    <select dojoType="openils.widget.PermGrpFilteringSelect" name="name" jsId='GPT.grpSelector'/>
                </td>
            </tr>
            <tr>
                <td><label for="org_unit">Context Org Unit: </label></td>
                <td>
                    <select dojoType="openils.widget.OrgUnitFilteringSelect" name="org_unit"
                        jsId='gptOwningOrg' searchAttr='shortname' labelAttr='shortname'/>
                </td>
            </tr>
            <tr>
                <td><label for="penalty">Penalty: </label></td>
                <td>
                    <select dojoType="dijit.form.FilteringSelect" jsId='GPT.penaltySelector' name="penalty"/>
                </td>
            </tr>
            <tr>
                <td><label for="threshold">Threshold: </label></td>
                <td><input dojoType="dijit.form.NumberTextBox" name="threshold"/></td>
            </tr>
            <tr>
                <td colspan='2' align='center'>
                    <button dojoType='dijit.form.Button' type="submit">Create</button>
                </td>
            </tr>
        </table>
    </div>
</div> 

<div dojoType="dijit.layout.ContentPane" layoutAlign="top">
    <div dojoType="dijit.layout.ContentPane" layoutAlign="client" style='height:600px;'>
        <table jsId="gptGrid" dojoType="dojox.grid.DataGrid" query="{id: '*'}" rowSelector='20px'>
            <thead>
                <tr>
                    <th field="id">ID</th>
                    <th field="grp" width='auto' get='GPT.getGroupName'>Group</th>
                    <th field="org_unit" width='auto' get='GPT.getOrgInfo'>Context Org Unit</th>
                    <th field="penalty" width='auto' get='GPT.getPenaltyInfo'>Penalty</th>
                    <th field="threshold" width='auto'>threshold</th>
                </tr>
            </thead>
        </table>    
    </div>
</div>

[% END %]


