<?xml version="1.0" encoding="UTF-8"?>
<tables>

	<table id="wide-copy" partition="false" fact-table="true">
		<label>Wide Copy info</label>
		<description>Base table for creating snapshot reports on copy information</description>
		<tablename>stats.fleshed_copy</tablename>

		<fields>
			<field
			  name="id"
			  primary="true"
			  create-type="serial"
			  datatype="int">
				<label>ID</label>
				<description>Copy ID</description>
			</field>
			<field
			  name="barcode"
			  datatype="text">
				<label>Barcode</label>
				<description>Copy Barcode</description>
			</field>
			<field
			  name="owning_lib"
			  datatype="int"
			  indexed="true">
				<label>Owner</label>
				<description>ID of the Owning Library</description>
			</field>
			<field
			  name="circ_lib"
			  datatype="int"
			  indexed="true">
				<label>Circulator</label>
				<description>ID of the Circulating Library</description>
			</field>
			<field
			  name="create_date"
			  datatype="timestamptz"
			  indexed="true"
			  default="now()">
				<label>Create Date</label>
				<description>Timestamp of the copy's cataloging</description>
			</field>
			<field
			  name="item_lang"
			  datatype="text">
				<label>Language</label>
				<description>MARC Item Language</description>
			</field>
			<field
			  name="item_form"
			  datatype="text">
				<label>Form</label>
				<description>MARC Item Form of Material</description>
			</field>
			<field
			  name="item_type"
			  datatype="text">
				<label>Type</label>
				<description>MARC Item Type</description>
			</field>
			<field
			  name="call_number_label"
			  datatype="text">
				<label>Call Number</label>
				<description>Copy Call Number Label</description>
			</field>
		</fields>

		<links>
			<link
			  field="owning_lib"
			  table="org_unit"
			  id="copy_owning_lib"
			  key="id"
			  type="has_a"/>
			<link
			  field="item_lang"
			  table="marc_lang_map"
			  id="copy_language"
			  key="code"
			  type="has_a"/>
			<link
			  field="circ_lib"
			  table="org_unit"
			  id="copy_circ_lib"
			  key="id"
			  type="has_a"/>
		</links>

	</table>
		
	<table id="org_unit" partition="false" fact-table="false">
		<label>Organizational Units</label>
		<description>Table containing library hierarchy definition</description>
		<tablename>actor.org_unit</tablename>

		<fields>
			<field
			  name="id"
			  primary="true"
			  create-type="serial"
			  datatype="int">
				<label>ID</label>
				<description>Library ID</description>
			</field>
			<field
			  name="name"
			  datatype="text">
				<label>Name</label>
				<description>Library Name</description>
			</field>
			<field
			  name="shortname"
			  datatype="text">
				<label>Short Name</label>
				<description>Library Short (Policy) Name</description>
			</field>
		</fields>
	</table>

	<table id="marc_lang_map" partition="false" fact-table="false">
		<label>MARC Language Codes</label>
		<description>Table mapping MARC three character codes to language names</description>
		<tablename>config.language_map</tablename>

		<fields>
			<field
			  name="code"
			  primary='true'
			  datatype="text">
				<label>Code</label>
				<description>MARC Language Code</description>
			</field>
			<field
			  name="value"
			  datatype="text">
				<label>Language Name</label>
				<description>Name associated with the MARC code</description>
			</field>
		</fields>
	</table>

	<table id="silly.fact" partition="true" fact-table="false">
		<label>Silly Fact table</label>
		<description>Base table for creating reports on silly words</description>
		<tablename>stats.silly_fact</tablename>

		<partition>
			<field>said_when</field>
			<!-- Valid options:  years, months, weeks, days, hours, minutes, seconds  -->
			<chunk>months</chunk>
			<start>2005-09-01</start>
			<end>2005-12-31</end>
		</partition>

		<fields>
			<field
			  name="id"
			  primary="true"
			  create-type="serial"
			  datatype="int">
				<label>Silly entry id</label>
				<description>Silly entry id</description>
			</field>
			<field
			  name="silly_word_dim"
			  datatype="int"
			  indexed="true">
				<label>Silly word dim</label>
				<description>Silly word entry dimension link</description>
			</field>
			<field
			  name="silly_sayer_dim"
			  datatype="int"
			  indexed="true">
				<label>Silly sayer dim</label>
				<description>Silly sayer entry dimension link</description>
			</field>
			<field
			  name="said_when"
			  datatype="timestamptz"
			  core="true"
			  indexed="true"
			  default="now()">
				<label>Silly word timestamp</label>
				<description>Silly word entry timestamp</description>
			</field>
		</fields>
		<links>
			<link
			  field="silly_word_dim"
			  table="silly.word_dim"
			  key="id"
			  type="has_a"/>
			<link
			  field="silly_sayer_dim"
			  table="silly.sayer_dim"
			  key="id"
			  type="has_a"/>
		</links>
	</table>

	<table id="silly.word_dim">
		<label>Silly word list</label>
		<description>Silly word list</description>
		<tablename>stats.words</tablename>
		<fields>
			<field
			  name="id"
			  primary="true"
			  create-type="serial"
			  datatype="int">
				<label>Silly word id</label>
			</field>
			<field
			  name="word"
			  datatype="text"
			  indexed="true"
			  index-type="BTREE">
				<label>Silly word</label>
			</field>
		</fields>
	</table>

	<table id="silly.sayer_dim">
		<label>Silly word sayer list</label>
		<description>Silly word sayer list</description>
		<tablename>stats.silly_sayers</tablename>
		<fields>
			<field
			  name="id"
			  primary="true"
			  create-type="serial"
			  datatype="int">
				<label>Silly person id</label>
			</field>
			<field
			  name="sayer"
			  widget-family="string-choose"
			  datatype="text"
			  indexed="true"
			  index-type="BTREE">
				<label>Silly person</label>
			</field>
		</fields>
	</table>

</tables>

