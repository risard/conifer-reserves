<?xml version="1.0"?>
<!-- Application: Evergreen Staff Client -->
<!-- Screen: Example Template for remote xul -->

<!-- ///////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
<!-- STYLESHEETS -->
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
<?xml-stylesheet href="chrome://open_ils_staff_client/skin/global.css" type="text/css"?>
<?xml-stylesheet href="/xul/server/skin/global.css" type="text/css"?>

<!-- ///////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
<!-- LOCALIZATION -->
<!DOCTYPE window PUBLIC "" ""[
	<!--#include virtual="/opac/locale/en-US/lang.dtd"-->
]>


<!-- ///////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
<!-- OVERLAYS -->
<?xul-overlay href="/xul/server/OpenILS/util_overlay.xul"?>

<window id="cat_z3950_win" 
	onload="try { my_init(); font_helper(); } catch(E) { alert(E); }"
	xmlns:html="http://www.w3.org/1999/xhtml"
	xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">

	<!-- ///////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
	<!-- BEHAVIOR -->
        <script type="text/javascript">
		var myPackageDir = 'open_ils_staff_client'; var IAMXUL = true; var g = {};
	</script>
        <scripts id="openils_util_scripts"/>

	<script type="text/javascript" src="/xul/server/main/JSAN.js"/>
	<script>
	<![CDATA[
		function my_init() {
			try {
				netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		                if (typeof JSAN == 'undefined') { throw( "The JSAN library object is missing."); }
				JSAN.errorLevel = "die"; // none, warn, or die
				JSAN.addRepository('/xul/server/');
				JSAN.use('util.error'); g.error = new util.error();
				g.error.sdump('D_TRACE','my_init() for cat_z3950.xul');

				JSAN.use('cat.z3950'); g.z3950 = new cat.z3950();

				g.z3950.init( 
					{ 
						/* this guy grabs most things through the DOM, but I want to move JSAN libraries away from that,
						or at the very least, push node ID's in through here. */
					} 
				);

				if (typeof window.xulG == 'object' && typeof window.xulG.set_tab_name == 'function') {
					try { window.xulG.set_tab_name('Z39.50'); } catch(E) { alert(E); }
				}

			} catch(E) {
				var err_msg = "!! This software has encountered an error.  Please tell your friendly " +
					"system administrator or software developer the following:\ncat/z3950.xul\n" + E + '\n';
				try { g.error.sdump('D_ERROR',err_msg); } catch(E) { dump(err_msg); }
				alert(err_msg);
			}
		}

		function handle_enter(ev) {
			g.z3950.handle_enter(ev);
		}

		function default_focus() {
			setTimeout( function() { try { document.getElementById("username").focus(); g.z3950.focus(g.service); } catch(E) { } }, 0 );
		}

	]]>
	</script>

	<commandset id="cat_z3950_cmds">
		<command id="cmd_broken" />
		<command id="cmd_export" />
		<command id="sel_clip" />
		<command id="save_columns" />
	</commandset>

	<groupbox flex="1">
		<caption label="MARC Import via Z39.50"/>
		<groupbox orient="horizontal">
			<caption id="c2" label="Service and Credentials" class="shrinkable_groupbox"/>
			<label value="Service:" />
			<hbox id="menu_placeholder" flex="1"/>
			<label value="Username:" control="username" accesskey="U"/>
			<textbox id="username" />
			<label value="Password:" control="password"/>
			<textbox id="password" />
			<button id="save_creds" label="Save as Default" accesskey="D"/>
		</groupbox>
		<groupbox>
			<caption label="Query" class="shrinkable_groupbox"/>
			<hbox>
				<spacer flex="1"/>
				<description>
					Tip: Click a search field label and then the "Save as Default" button to have that field focused by default.
				</description>
				<spacer flex="1"/>
			</hbox>
			<grid>
				<columns><column /><column flex="1" /><column /><column flex="1"/><column /><column flex="1"/></columns>
				<rows id="query_inputs">
					<row>
						<label value="&staff.z39_50.search_class.tcn;" control="tcn_input" onclick="g.z3950.default_attr = 'tcn'" accesskey="0" style="-moz-user-focus: ignore"/>
						<textbox id="tcn_input" mytype="search_class" search_class="tcn" onkeypress="handle_enter(event)"/>
						<label value="&staff.z39_50.search_class.isbn;" control="isbn_input" onclick="g.z3950.default_attr = 'isbn'" style="-moz-user-focus: ignore"/>
						<textbox id="isbn_input" mytype="search_class" search_class="isbn" onkeypress="handle_enter(event)"/>
						<label value="&staff.z39_50.search_class.issn;" control="issn_input" onclick="g.z3950.default_attr = 'issn'" style="-moz-user-focus: ignore"/>
						<textbox id="issn_input" mytype="search_class" search_class="issn" onkeypress="handle_enter(event)"/>
					</row>
					<row>
						<label value="&staff.z39_50.search_class.title;" control="title_input" onclick="g.z3950.default_attr = 'title'" style="-moz-user-focus: ignore"/>
						<textbox id="title_input" mytype="search_class" search_class="title" onkeypress="handle_enter(event)"/>
						<label value="&staff.z39_50.search_class.author;" control="author_input" onclick="g.z3950.default_attr = 'author'" style="-moz-user-focus: ignore"/>
						<textbox id="author_input" mytype="search_class" search_class="author" onkeypress="handle_enter(event)"/>
						<label value="&staff.z39_50.search_class.lccn;" control="lccn_input" onclick="g.z3950.default_attr = 'lccn'" style="-moz-user-focus: ignore"/>
						<textbox id="lccn_input" mytype="search_class" search_class="lccn" onkeypress="handle_enter(event)"/>
					</row>
					<row>
						<label value="&staff.z39_50.search_class.pubdate;" control="pubdate_input" onclick="g.z3950.default_attr = 'pubdate'" style="-moz-user-focus: ignore"/>
						<textbox id="pubdate_input" mytype="search_class" search_class="pubdate" onkeypress="handle_enter(event)"/>
						<label value="&staff.z39_50.search_class.publisher;" control="publisher_input" onclick="g.z3950.default_attr = 'publisher'" style="-moz-user-focus: ignore"/>
						<textbox id="publisher_input" mytype="search_class" search_class="publisher" onkeypress="handle_enter(event)"/>
						<label value="&staff.z39_50.search_class.item_type;" control="item_type_input" onclick="g.z3950.default_attr = 'item_type'" style="-moz-user-focus: ignore"/>
						<menulist id="item_type_input" mytype="search_class" search_class="item_type">
							<menupopup>
								<menuitem label="&staff.z39_50.search_class.item_type.all;" value=""/>
								<menuitem label="&staff.z39_50.search_class.item_type.bks;" value="bks"/>
								<menuitem label="&staff.z39_50.search_class.item_type.ser;" value="ser"/>
								<menuitem label="&staff.z39_50.search_class.item_type.vis;" value="vis"/>
								<menuitem label="&staff.z39_50.search_class.item_type.rec;" value="rec"/>
								<menuitem label="&staff.z39_50.search_class.item_type.sco;" value="sco"/>
								<menuitem label="&staff.z39_50.search_class.item_type.map;" value="map"/>
								<menuitem label="&staff.z39_50.search_class.item_type.com;" value="com"/>
								<menuitem label="&staff.z39_50.search_class.item_type.mix;" value="mix"/>
								<menuitem label="&staff.z39_50.search_class.item_type.url;" value="url"/>
								<menuitem label="&staff.z39_50.search_class.item_type.art;" value="art"/>
							</menupopup>
						</menulist>
					</row>
				</rows>
			</grid>
			<spacer flex="1"/>
			<hbox>
				<button id="raw_search" label="Raw Search" accesskey="w"/>
				<spacer flex="1"/>
				<button id="clear" label="Clear Form" accesskey="C"/>
				<button id="search" label="Search" accesskey="S"/>
			</hbox>
		</groupbox>
		<splitter><grippy/></splitter>
		<groupbox flex="1">
			<caption label="Results" />
			<vbox id="result_message" />
			<hbox>
				<button id="page_next" label="Fetch More Results" accesskey="M" disabled="true"/>
				<button id="export" label="Export" command="cmd_export" accesskey=""/>
				<button id="clip_button" command="sel_clip" label="Copy to Clipboard" disabled="true"/>
				<button id="save_cols_btn" command="save_columns" label="Save Columns" />
				<spacer flex="1"/>
				<button id="marc_view" label="MARC View" accesskey="V" disabled="true"/>
				<button id="marc_import_overlay" label="MARC Editor for Overlay" accesskey="O" disabled="true"/>
				<button id="marc_import" label="MARC Editor for Import" accesskey="I" disabled="true"/>
			</hbox>
			<deck id="deck" flex="1">
				<tree id="results" flex="1" enableColumnDrag="true" seltype="single"/>
				<iframe id="marc_frame" src="/xul/server/cat/marc_view.html" flex="1"/>
			</deck>
		</groupbox>
	</groupbox>

</window>

